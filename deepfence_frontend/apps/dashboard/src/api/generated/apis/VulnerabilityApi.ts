/* tslint:disable */
/* eslint-disable */
/**
 * Deepfence ThreatMapper
 * Deepfence Runtime API provides programmatic control over Deepfence microservice securing your container, kubernetes and cloud deployments. The API abstracts away underlying infrastructure details like cloud provider,  container distros, container orchestrator and type of deployment. This is one uniform API to manage and control security alerts, policies and response to alerts for microservices running anywhere i.e. managed pure greenfield container deployments or a mix of containers, VMs and serverless paradigms like AWS Fargate.
 *
 * The version of the OpenAPI document: 2.0.0
 * Contact: community@deepfence.io
 *
 * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).
 * https://openapi-generator.tech
 * Do not edit the class manually.
 */


import * as runtime from '../runtime';
import type {
  ApiDocsBadRequestResponse,
  ApiDocsFailureResponse,
  IngestersVulnerability,
  ModelScanStatusResp,
  ModelScanTriggerReq,
  ModelScanTriggerResp,
} from '../models';
import {
    ApiDocsBadRequestResponseFromJSON,
    ApiDocsBadRequestResponseToJSON,
    ApiDocsFailureResponseFromJSON,
    ApiDocsFailureResponseToJSON,
    IngestersVulnerabilityFromJSON,
    IngestersVulnerabilityToJSON,
    ModelScanStatusRespFromJSON,
    ModelScanStatusRespToJSON,
    ModelScanTriggerReqFromJSON,
    ModelScanTriggerReqToJSON,
    ModelScanTriggerRespFromJSON,
    ModelScanTriggerRespToJSON,
} from '../models';

export interface IngestVulnerabilitiesRequest {
    ingestersVulnerability?: Array<IngestersVulnerability> | null;
}

export interface StartVulnerabilityScanRequest {
    modelScanTriggerReq?: ModelScanTriggerReq;
}

export interface StatusVulnerabilityScanRequest {
    scanId: string;
}

export interface StopVulnerabilityScanRequest {
    modelScanTriggerReq?: ModelScanTriggerReq;
}

/**
 * VulnerabilityApi - interface
 * 
 * @export
 * @interface VulnerabilityApiInterface
 */
export interface VulnerabilityApiInterface {
    /**
     * Ingest vulnerabilities found while scanning the agent host or containers
     * @summary Ingest Vulnerabilities
     * @param {Array<IngestersVulnerability>} [ingestersVulnerability] 
     * @param {*} [options] Override http request option.
     * @throws {RequiredError}
     * @memberof VulnerabilityApiInterface
     */
    ingestVulnerabilitiesRaw(requestParameters: IngestVulnerabilitiesRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>>;

    /**
     * Ingest vulnerabilities found while scanning the agent host or containers
     * Ingest Vulnerabilities
     */
    ingestVulnerabilities(requestParameters: IngestVulnerabilitiesRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void>;

    /**
     * Start Vulnerability Scan on agent or registry
     * @summary Start Vulnerability Scan
     * @param {ModelScanTriggerReq} [modelScanTriggerReq] 
     * @param {*} [options] Override http request option.
     * @throws {RequiredError}
     * @memberof VulnerabilityApiInterface
     */
    startVulnerabilityScanRaw(requestParameters: StartVulnerabilityScanRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<ModelScanTriggerResp>>;

    /**
     * Start Vulnerability Scan on agent or registry
     * Start Vulnerability Scan
     */
    startVulnerabilityScan(requestParameters: StartVulnerabilityScanRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<ModelScanTriggerResp>;

    /**
     * Get Vulnerability Scan Status on agent or registry
     * @summary Get Vulnerability Scan Status
     * @param {string} scanId 
     * @param {*} [options] Override http request option.
     * @throws {RequiredError}
     * @memberof VulnerabilityApiInterface
     */
    statusVulnerabilityScanRaw(requestParameters: StatusVulnerabilityScanRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<ModelScanStatusResp>>;

    /**
     * Get Vulnerability Scan Status on agent or registry
     * Get Vulnerability Scan Status
     */
    statusVulnerabilityScan(requestParameters: StatusVulnerabilityScanRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<ModelScanStatusResp>;

    /**
     * Stop Vulnerability Scan on agent or registry
     * @summary Stop Vulnerability Scan
     * @param {ModelScanTriggerReq} [modelScanTriggerReq] 
     * @param {*} [options] Override http request option.
     * @throws {RequiredError}
     * @memberof VulnerabilityApiInterface
     */
    stopVulnerabilityScanRaw(requestParameters: StopVulnerabilityScanRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>>;

    /**
     * Stop Vulnerability Scan on agent or registry
     * Stop Vulnerability Scan
     */
    stopVulnerabilityScan(requestParameters: StopVulnerabilityScanRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void>;

}

/**
 * 
 */
export class VulnerabilityApi extends runtime.BaseAPI implements VulnerabilityApiInterface {

    /**
     * Ingest vulnerabilities found while scanning the agent host or containers
     * Ingest Vulnerabilities
     */
    async ingestVulnerabilitiesRaw(requestParameters: IngestVulnerabilitiesRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>> {
        const queryParameters: any = {};

        const headerParameters: runtime.HTTPHeaders = {};

        headerParameters['Content-Type'] = 'application/json';

        if (this.configuration && this.configuration.accessToken) {
            const token = this.configuration.accessToken;
            const tokenString = await token("bearer_token", []);

            if (tokenString) {
                headerParameters["Authorization"] = `Bearer ${tokenString}`;
            }
        }
        const response = await this.request({
            path: `/deepfence/ingest/vulnerabilities`,
            method: 'POST',
            headers: headerParameters,
            query: queryParameters,
            body: requestParameters.ingestersVulnerability?.map(IngestersVulnerabilityToJSON),
        }, initOverrides);

        return new runtime.VoidApiResponse(response);
    }

    /**
     * Ingest vulnerabilities found while scanning the agent host or containers
     * Ingest Vulnerabilities
     */
    async ingestVulnerabilities(requestParameters: IngestVulnerabilitiesRequest = {}, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void> {
        await this.ingestVulnerabilitiesRaw(requestParameters, initOverrides);
    }

    /**
     * Start Vulnerability Scan on agent or registry
     * Start Vulnerability Scan
     */
    async startVulnerabilityScanRaw(requestParameters: StartVulnerabilityScanRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<ModelScanTriggerResp>> {
        const queryParameters: any = {};

        const headerParameters: runtime.HTTPHeaders = {};

        headerParameters['Content-Type'] = 'application/json';

        if (this.configuration && this.configuration.accessToken) {
            const token = this.configuration.accessToken;
            const tokenString = await token("bearer_token", []);

            if (tokenString) {
                headerParameters["Authorization"] = `Bearer ${tokenString}`;
            }
        }
        const response = await this.request({
            path: `/deepfence/scan/start/vulnerability`,
            method: 'POST',
            headers: headerParameters,
            query: queryParameters,
            body: ModelScanTriggerReqToJSON(requestParameters.modelScanTriggerReq),
        }, initOverrides);

        return new runtime.JSONApiResponse(response, (jsonValue) => ModelScanTriggerRespFromJSON(jsonValue));
    }

    /**
     * Start Vulnerability Scan on agent or registry
     * Start Vulnerability Scan
     */
    async startVulnerabilityScan(requestParameters: StartVulnerabilityScanRequest = {}, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<ModelScanTriggerResp> {
        const response = await this.startVulnerabilityScanRaw(requestParameters, initOverrides);
        return await response.value();
    }

    /**
     * Get Vulnerability Scan Status on agent or registry
     * Get Vulnerability Scan Status
     */
    async statusVulnerabilityScanRaw(requestParameters: StatusVulnerabilityScanRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<ModelScanStatusResp>> {
        if (requestParameters.scanId === null || requestParameters.scanId === undefined) {
            throw new runtime.RequiredError('scanId','Required parameter requestParameters.scanId was null or undefined when calling statusVulnerabilityScan.');
        }

        const queryParameters: any = {};

        if (requestParameters.scanId !== undefined) {
            queryParameters['scan_id'] = requestParameters.scanId;
        }

        const headerParameters: runtime.HTTPHeaders = {};

        if (this.configuration && this.configuration.accessToken) {
            const token = this.configuration.accessToken;
            const tokenString = await token("bearer_token", []);

            if (tokenString) {
                headerParameters["Authorization"] = `Bearer ${tokenString}`;
            }
        }
        const response = await this.request({
            path: `/deepfence/scan/status/vulnerability`,
            method: 'GET',
            headers: headerParameters,
            query: queryParameters,
        }, initOverrides);

        return new runtime.JSONApiResponse(response, (jsonValue) => ModelScanStatusRespFromJSON(jsonValue));
    }

    /**
     * Get Vulnerability Scan Status on agent or registry
     * Get Vulnerability Scan Status
     */
    async statusVulnerabilityScan(requestParameters: StatusVulnerabilityScanRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<ModelScanStatusResp> {
        const response = await this.statusVulnerabilityScanRaw(requestParameters, initOverrides);
        return await response.value();
    }

    /**
     * Stop Vulnerability Scan on agent or registry
     * Stop Vulnerability Scan
     */
    async stopVulnerabilityScanRaw(requestParameters: StopVulnerabilityScanRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>> {
        const queryParameters: any = {};

        const headerParameters: runtime.HTTPHeaders = {};

        headerParameters['Content-Type'] = 'application/json';

        if (this.configuration && this.configuration.accessToken) {
            const token = this.configuration.accessToken;
            const tokenString = await token("bearer_token", []);

            if (tokenString) {
                headerParameters["Authorization"] = `Bearer ${tokenString}`;
            }
        }
        const response = await this.request({
            path: `/deepfence/scan/stop/vulnerability`,
            method: 'POST',
            headers: headerParameters,
            query: queryParameters,
            body: ModelScanTriggerReqToJSON(requestParameters.modelScanTriggerReq),
        }, initOverrides);

        return new runtime.VoidApiResponse(response);
    }

    /**
     * Stop Vulnerability Scan on agent or registry
     * Stop Vulnerability Scan
     */
    async stopVulnerabilityScan(requestParameters: StopVulnerabilityScanRequest = {}, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void> {
        await this.stopVulnerabilityScanRaw(requestParameters, initOverrides);
    }

}
